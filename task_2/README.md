# Инструкция по запуску автоматизированных тестов API

## Описание
Данная папка содержит тест-кейсы и автоматизированные тесты для API микросервиса объявлений Авито.

**Host:** https://qa-internship.avito.com  
**Base URL:** https://qa-internship.avito.com/api/1

## Структура файлов
- `TESTCASES.md` - тест-кейсы для ручного тестирования (28 тест-кейсов)
- `test_api.py` - автоматизированные тесты на Python + pytest
- `requirements.txt` - зависимости проекта
- `BUGS.md` - баг-репорты, найденные при тестировании
- `README.md` - данный файл с инструкцией

## Предварительные требования

1. **Python 3.7+** должен быть установлен
2. **pip** (менеджер пакетов Python)

Проверка установки:
```bash
python --version
# или
py --version
```

## Установка зависимостей

### Вариант 1: Установка из файла requirements.txt
```bash
pip install -r requirements.txt
```

### Вариант 2: Установка пакетов вручную
```bash
pip install pytest==7.4.3 requests==2.31.0
```

## Запуск тестов

### Запуск всех тестов
```bash
pytest test_api.py -v
```

### Запуск с подробным выводом
```bash
pytest test_api.py -v -s
```

### Запуск конкретного теста
```bash
pytest test_api.py::TestAdsAPI::test_create_ad_success -v
```

### Запуск тестов с выводом в консоль
```bash
pytest test_api.py -v --tb=short
```

### Запуск через Python модуль
```bash
python -m pytest test_api.py -v
```

## Описание API эндпоинтов

### 1. Создание объявления
**POST** `/api/1/item`

**Тело запроса:**
```json
{
  "sellerID": 123456,
  "name": "Название объявления",
  "price": 5000,
  "statistics": {
    "contacts": 3,
    "likes": 10,
    "viewCount": 5
  }
}
```

**Ответ при успехе (200):**
```json
{
  "status": "<string>"
}
```

**Ответ при ошибке (400):**
```json
{
  "result": {
    "messages": {},
    "message": "<string>"
  },
  "status": "<string>"
}
```

### 2. Получение объявления по ID
**GET** `/api/1/item/:id`

**Ответ (200):**
```json
[
  {
    "id": "<string>",
    "sellerId": "<integer>",
    "name": "<string>",
    "price": "<integer>",
    "statistics": {
      "likes": "<integer>",
      "viewCount": "<integer>",
      "contacts": "<integer>"
    },
    "createdAt": "<string>"
  }
]
```

### 3. Получение всех объявлений продавца
**GET** `/api/1/:sellerID/item`

**Ответ (200):**
```json
[
  {
    "id": "<string>",
    "sellerId": "<integer>",
    "name": "<string>",
    "price": "<integer>",
    "statistics": {
      "likes": "<integer>",
      "viewCount": "<integer>",
      "contacts": "<integer>"
    },
    "createdAt": "<string>"
  }
]
```

### 4. Получение статистики
**GET** `/api/1/statistic/:id`

**Ответ (200):**
```json
[
  {
    "likes": "<integer>",
    "viewCount": "<integer>",
    "contacts": "<integer>"
  }
]
```

## Важные замечания

1. **sellerID** должен быть в диапазоне **111111-999999**
2. **id** объявления - это UUID строка, генерируется автоматически
3. При создании объявлений используйте уникальные `sellerID`, чтобы избежать конфликтов с другими тестировщиками
4. Тесты автоматически генерируют уникальные `sellerID` для каждого запуска
5. При создании объявления API возвращает только `status`, для получения `id` нужно использовать GET запрос по `sellerID`

## Ожидаемые результаты

Все автоматизированные тесты должны быть пройдены успешно. Если какой-то тест падает, это может указывать на:
- Баг в API
- Проблемы с сетью
- Изменения в API (несоответствие документации)

## Найденные баги

Если в процессе тестирования были обнаружены баги, они описаны в файле `BUGS.md`.

## Структура тестов

Тесты организованы по классу `TestAdsAPI` и покрывают:
- ✅ Создание объявлений (9 тестов)
- ✅ Получение объявления по ID (4 теста)
- ✅ Получение объявлений продавца (5 тестов)
- ✅ Получение статистики (4 теста)
- ✅ Интеграционные тесты (3 теста)
- ✅ Негативные тесты (3 теста)

**Всего:** 28 автоматизированных тестов

## Устранение проблем

### Ошибка: ModuleNotFoundError
**Решение:** Убедитесь, что зависимости установлены:
```bash
pip install -r requirements.txt
```

### Ошибка: Connection refused / Timeout
**Решение:** Проверьте доступность API:
```bash
curl https://qa-internship.avito.com/api/1/item
```

### Тесты падают с ошибкой 400/500
**Решение:** Проверьте, что API доступен и работает корректно. Возможно, это баг, который нужно зафиксировать в `BUGS.md`.

